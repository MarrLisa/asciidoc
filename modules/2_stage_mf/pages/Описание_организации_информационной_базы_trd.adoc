include::common/contract.adoc[]
:docinfo: shared
:!chapter-signifier:
:!section-refsig:
:figure-caption!:
:imagesdir: ../images
:table-caption!: 
:section-refsig: разделе
:toc: macro
:toc-title: Содержание 
:name1_dokument: Описание организации информационной базы
:name5_dokument: 
:sectnumlevels: 7
// Кол-во страниц соответствует пдф и версия
:version: 1
:page_all: 22
:code: П6
:toclevels: 4
:ramka: 1
:plan:
// :title-page: — это директива, которая создает отдельную страницу титульного листа для документа.

//Служеб. настрока титульника. Менять год здесь
include::tables/titul_doc.adoc[]

<<<<
toc::[]

<<<<
:!sectnums: 
== Перечень терминов и сокращений
[cols="2*", options="header"]
|===
^| Термин/сокращение            ^| Определение/расшифровка
| База данных                  | Совокупность данных, хранимых в соответствии со схемой данных, манипулирование которыми выполняют в соответствии с правилами средств моделирования данных
| Информационная система       | Совокупность содержащейся в базах данных информации и обеспечивающих ее обработку информационных технологий и технических средств
| Модуль                       | Модуль организации предоставления в электронном виде мер государственной финансовой поддержки юридическим лицам, индивидуальным предпринимателям, а также физическим лицам – производителям товаров, работ, услуг в Подсистеме управления расходами государственной интегрированной информационной системы управления общественными финансами «Электронный бюджет»
| Набор данных                 | Идентифицированная совокупность физических записей, организованная одним из установленных в системе обработки данных способов и представляющая файлы или части файлов в среде хранения
| Система «Электронный бюджет» | Государственная интегрированная информационная система управления общественными финансами «Электронный бюджет»
| https://dbeaver.io/          | Официальный сайт DBeaver. DBeaver – это бесплатная программа с открытым исходным кодом, являющаяся клиентом баз данных и инструментом администрирования SQL
| png                          | Растровый формат хранения графической информации, использующий сжатие без потерь                                                                                                                                         
|===

<<<<

// Основная часть ********************
:sectnums: 

[%breakable]
== Описание внутримашинной информационной базы
=== Логическая структура базы данных
==== Логическая структура данных Конструктора представления данных

:num_i: {counter:figure-number}
Eпрощенная логическая схема данных, участвующих в процессе Конструктора представления данных изображена на <<id_i_{num_i}, Рисунке {num_i}>>. Шаблон содержит информацию о настройках отображения и запроса данных, которые могут быть использованы модулями рабочей панели. На момент создания шаблон не связан с другими сущностями, но может быть впоследствии прикреплен к модулю.

[%breakable]
[#id_i_{num_i}]
.Рисунок {num_i}. Логическая структура Конструктора представления данных
image::schema_construct_oib.png[]

:num_t: {counter:table-number}
Схема демонстрирует основные сущности и связи между ними, подробное описание приведено в <<id_t_{num_t}, Таблице {num_t}>>.

[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Логическая структура Конструктора представления данных
[cols="2,2,2,5,3", options="header"]
|===
^| Сущность (Таблица) ^| Атрибут     ^| Тип данных ^| Описание                                                                                                                                   ^| Связь с другими сущностями
.6+| Template (Шаблоны) | Id          | integer    | Первичный ключ                                                                                                                             | –                         
                    | Name        | varchar    | Системное имя шаблона                                                                                                                      | –                         
                    | Title       | varchar    | Заголовок шаблона                                                                                                                          | –                         
                    | IsPublished | boolean    | Флаг публикации шаблона. true - опубликован, false - черновик                                                                              | –                         
                    | Type        | integer    | Тип шаблона (реестр, карточка и т.д.)                                                                                                      | –                         
                    | ViewJson    | text       | JSON-конфигурация отображения данных, определяющая, как данные будут представлены в интерфейсе (названия столбцов, порядок, формат и т.д.) | –                         
|===

Сущность Template хранит информацию, необходимую для отображения данных в определенном формате (реестр, карточка). ViewJson определяет внешний вид представления (например, названия и порядок столбцов в реестре), а QueryJson определяет, какие данные будут отображаться. Шаблон не имеет прямых связей с другими сущностями на момент создания, но может быть использован модулями рабочей панели (сущность Module), которые будут ссылаться на него через внешний ключ TemplateId.

[%breakable]
==== Логическая структура данных Конструктора панели навигации

:num_i: {counter:figure-number}
Упрощенная логическая схема данных, участвующих в процессе Конструктора панели навигации, изображена на <<id_i_{num_i}, Рисунке {num_i}>>. Схема описывает структуру данных для модулей рабочей панели и их связь с шаблонами представлений данных. Каждый модуль может быть вложен в другой модуль, образуя иерархическую структуру. Модули типа "Представление данных" связаны с шаблонами, определяющими отображение данных. 


[%breakable]
[#id_i_{num_i}]
.Рисунок {num_i}. Логическая структура Конструктора панели навигации
image::log_schema_constr.png[]

:num_t: {counter:table-number}
Схема демонстрирует основные сущности и связи между ними, подробнее расписано в <<id_t_{num_t}, Таблице {num_t}>>.

[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Логическая структура данных Конструктора панели навигации
include::tables/t_constructor_nav_oib.adoc[]

[%breakable]
==== Логическая структура данных Конструктором форм

:num_i: {counter:figure-number}
Упрощенная логическая схема данных, участвующих в процессе Конструктора форм, изображена на <<id_i_{num_i}, Рисунке {num_i}>>. Схема представляет собой модель данных для конструктора форм, позволяющего создавать гибкие и настраиваемые формы для различных типов объектов. Она включает сущности для описания шаблонов форм, типов форм, типов объектов, свойств типов объектов, значений полей форм, а также материализованное представление для оптимизации доступа к данным.

[%breakable]
[#id_i_{num_i}]
.Рисунок {num_i}. Логическая структура Конструктора форм
image::log_schema_constr2.png[]

:num_t: {counter:table-number}
Схема демонстрирует основные сущности и связи между ними, подробнее расписано в <<id_t_{num_t}, Таблице {num_t}>>.
 
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Логическая структура данных процесса Конструктора форм
include::tables/t_constructor_form_oib.adoc[]

[%breakable]
==== Логическая структура данных процесса подписания документов

:num_i: {counter:figure-number}
Упрощенная логическая схема данных, участвующих в процессе подписания документов, изображена на <<id_i_{num_i}, Рисунке {num_i}>>. 
[%breakable]
[#id_i_{num_i}]
.Рисунок {num_i}. Логическая структура подписания документов
image::log_schema_doc.png[]

:num_t: {counter:table-number}
Схема демонстрирует основные сущности и связи между ними, подробнее расписано в  <<id_t_{num_t}, Таблице {num_t}>>.
Таблица 4. Логическая структура данных, связанных с процессом подписания 
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Логическая структура данных подписания документов
[cols="2,2,2,5,3", options="header"]
|===
^| Сущность (Таблица)                                     ^| Атрибут              ^| Тип данных ^| Описание                                                                   ^| Связь с другими сущностями
.3+| Application (Заявки)                                   | Id                   | UUID       | Первичный ключ                                                             | –                         
                                                        | IsOnSigning          | boolean    | Флаг, указывающий, находится ли заявка в процессе подписания               | –                         
                                                        | SigningId            | UUID       | Внешний ключ, ссылающийся на таблицу Sign                                  | Sign                      
.2+| ApplicationVersion (Версии заявок)                     | Id                   | UUID       | Первичный ключ                                                             | –                         
                                                        | InternalId           | UUID       | Внутренний идентификатор, внешний ключ, ссылающийся на таблицу Application | Application               
.3+| ApplicationSectionDocument (Документы разделов заявок) | Id                   | UUID       | Первичный ключ                                                             | –                         
                                                        | FileId               | UUID       | Внешний ключ, ссылающийся на таблицу file                                  | file                      
                                                        | ApplicationVersionId | UUID       | Внешний ключ, ссылающийся на таблицу ApplicationVersion                    | ApplicationVersion        
.7+| Sign (Подписи)                                         | Id                   | UUID       | Первичный ключ                                                             | –                         
                                                        | ObjectId             | UUID       | Внешний ключ, ссылающийся на таблицу Application                           | Application               
                                                        | Status               | integer    | Статус подписания                                                          | –                         
                                                        | PdfId                | UUID       | Внешний ключ, ссылающийся на таблицу file                                  | file                      
                                                        | XmlId                | UUID       | Внешний ключ, ссылающийся на таблицу file                                  | file                      
                                                        | DocId                | UUID       | Внешний ключ, ссылающийся на таблицу file                                  | file                      
                                                        | SettingsId           | UUID       | Идентификатор настроек подписания                                          | –                         
| file (Файлы)                                           | Id                   | UUID       | Первичный ключ                                                             | –                         
|===

[%breakable]
==== Логическая структура данных, связанных с процессом авторизации

:num_i: {counter:figure-number}
Упрощенная логическая схема данных, участвующих в процессе авторизации, изображена на <<id_i_{num_i}, Рисунке {num_i}>>. 
 
[%breakable]
[#id_i_{num_i}]
.Рисунок {num_i}. Логическая структура авторизации
image::log_schema_autoriz.png[]

:num_t: {counter:table-number}
Схема демонстрирует основные сущности и связи между ними, подробнее расписано в  <<id_t_{num_t}, Таблице {num_t}>>.
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Логическая структура данных процесса авторизации
include::tables/t_constructor_autoriz_oib.adoc[]

[%breakable]
=== Перечень наборов данных и реквизитов наборов данных 

:num_t: {counter:table-number}
Перечень наборов данных и реквизитов наборов данных, задействованных при адаптации (модификации) ППО приведен в  <<id_t_{num_t}, Таблице {num_t}>>.
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Перечень схем баз данных, которые были задействованы в развитие Модуля
[cols="1,4,8", options="header"]
|===
^| № +
п/п  ^| Наименование схемы БД        ^| Описание                                                                                                                                                                                 
| {counter:t_row}. | myrtex-minfin-navigator-prod | Конструктор представлений данных. Отвечает за вывод в интерфейсе структурированных данных пользователям (реестры, карточки), их фильтрацию, сортировку и выгрузку, а также Рабочей панели
| {counter:t_row}. | myrtex-minfin-project-prod   | Конструктор форм. Отвечает за вывод в интерфейсе структурированных форм, для формирования шаблонов.                                                                                      
| {counter:t_row}. | myrtex-minfin-sign-prod      | Сервис «Подписание документов объекта»                                                                                                                                                   
| {counter:t_row}. | myrtex-minfin- access -prod  | Система управления правами доступа для приложения                                                                                                                                        
| {counter:t_row}. | myrtex-minfin- unit -prod    | Пакетное решение для хранения информации по организациям и профилям пользователей                                                                                                        
|===
:!t_row:

[%breakable]
==== Схема «navigator»

:num_t: {counter:table-number}
Наборы данных и их обозначение схемы БД «navigator» представлены в <<id_t_{num_t}, Таблице {num_t}>>.
 
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Перечень набора данных схемы «navigator»
include::tables/t_schema_navigator.adoc[]

[%breakable]
==== Схема «project»

:num_t: {counter:table-number}
Наборы данных и их обозначение схемы БД «project» представлены в <<id_t_{num_t}, Таблице {num_t}>>.
 
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Перечень набора данных схемы «project»
include::tables/t_schema_project.adoc[]

[%breakable]
==== Схема «access»

:num_t: {counter:table-number}
Наборы данных и их обозначение схемы БД «access» представлены в <<id_t_{num_t}, Таблице {num_t}>>.
 
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Перечень набора данных схемы «access»
include::tables/t_schema_access.adoc[]

[%breakable]
==== Схема «unit»

:num_t: {counter:table-number}
Наборы данных и их обозначение схемы БД «unit» представлены в <<id_t_{num_t}, Таблице {num_t}>>.
 
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Перечень набора данных схемы «unit»
include::tables/t_schema_unit.adoc[]

[%breakable]
=== Физическая структура 

:num_i_1: {counter:figure-number}
:num_i_2: {counter:figure-number}
:num_i_3: {counter:figure-number}
:num_i_4: {counter:figure-number}

Схема физической структуры данных, задействованных при развитии ППО, представлена на рисунках (<<id_i_{num_i_1}, Рисунок {num_i_1}>> – <<id_i_{num_i_4}, Рисунок {num_i_4}>>). 
 
[%breakable]
[#id_i_{num_i_1}]
.Рисунок {num_i_1}. Физическая структура схемы «navigator»
image::fiz_baza_1.png[]

[%breakable]
[#id_i_{num_i_2}]
.Рисунок {num_i_2}. Физическая структура схемы «project»
image::fiz_baza_2.png[]

[%breakable]
[#id_i_{num_i_3}]
.Рисунок {num_i_1}. Физическая структура  схемы «access»
image::fiz_baza_3.png[]

[%breakable]
[#id_i_{num_i_4}]
.Рисунок {num_i_4}. Физическая структура схемы «unit»
image::fiz_baza_4.png[]

[%breakable]
=== Организация ведения внутримашинной информационной базы

Для хранения данных используется база данных под управлением системы управления базами данных (далее – СУБД) PostreSQL.

:num_t: {counter:table-number}
Список схем базы данных (БД), используемых в Модуле приведен в <<id_t_{num_t}, Таблице {num_t}>>.
 
[%breakable]
[#id_t_{num_t}]
.Таблица {num_t}. Перечень схем баз данных и их назначение
include::tables/t_schema_bd_all_oib.adoc[]

Корректировка информации в базах данных осуществляется:

* посредством ввода данных пользователями системы через пользовательские интерфейсы компонента;
* посредством приема информации от внешних информационных систем в автоматизированном виде.

За обеспечение работоспособности базы данных, организацию резервного копирования, взаимодействие с технической поддержкой по вопросам функционирования БД несет ответственность администратор базы данных.
Описание регламентов обслуживания баз данных средствами СУБД приведено в документе «Руководство по администрированию». 


[.portrait]
<<<<
include::tables/t_podpis.adoc[]

<<<<
include::tables/t_list_change.adoc[]
